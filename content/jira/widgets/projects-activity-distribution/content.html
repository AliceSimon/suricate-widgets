<div class="grid-stack-item-content-inner">
	<h1 class="title">{{SURI_TITLE}}</h1>
	<div class="chart-container">
		<canvas id="chart-{{SURI_INSTANCE_ID}}"></canvas>
	</div>
</div>
<div class="jira"></div>

<script>
    $(function() {
      $(window).on('load', loadChart{{SURI_INSTANCE_ID}});

      function loadChart{{SURI_INSTANCE_ID}}() {
        $("#chart-{{SURI_INSTANCE_ID}}").height($(".widget-{{SURI_INSTANCE_ID}}").height() - 130);
        $("#chart-{{SURI_INSTANCE_ID}}").width($(".widget-{{SURI_INSTANCE_ID}}").width() - 40);
        var ctx = document.getElementById("chart-{{SURI_INSTANCE_ID}}").getContext('2d');
        
		var labels = [];
		var backgroundColors = [];
		var borderColors = [];
		var data = [];
		
		{{#labels}}
		labels = {{{labels}}};
		{{/labels}}
		
		{{#colors}}
		backgroundColors = {{{colors}}};
		{{/colors}}
		
		{{#border}}
		borderColors = {{{border}}};
		{{/border}}
		
		{{#datapie}}
		data = {{{datapie}}};
		{{/datapie}}
			
		var chart = new Chart(ctx, {
          type: '{{{SURI_TYPE_GRAPH}}}',
          data: {
            labels: labels,
            datasets: [{
              backgroundColor: backgroundColors,
              borderColor: borderColors,
              data: data
            }],
            borderWidth: 1
          },
          options: {
            legend: {
              display: '{{{SURI_TYPE_GRAPH}}}' == 'pie' ? true : false,
              labels: {
                fontColor: "white"
              },
              position: 'bottom'
            },
            scales: {
              xAxes: [{
                display: '{{{SURI_TYPE_GRAPH}}}' == 'pie' ? false : true,
                gridLines: {
                  color: "rgba(255, 255, 255, 0.4)",
                  zeroLineColor: "rgb(255, 255, 255)"
                },
                ticks: {
                  autoSkip: true,
                  fontColor: "#FFFFFF",
                  maxTicksLimit: 35
                }
              }],
              yAxes: [{
                display: '{{{SURI_TYPE_GRAPH}}}' == 'pie' ? false : true,
                gridLines: {
                  color: "rgba(255, 255, 255, 0.4)",
                  zeroLineColor: "rgb(255, 255, 255)"
                },
                ticks: {
                  autoSkip: true,
                  fontColor: "#FFFFFF",
                  maxTicksLimit: 35
                }
              }]
            },
            pieceLabel: {
              render: 'value',
              fontSize: 17,
              fontStyle: 'bold',
              fontColor: 'white',
              fontFamily: '"Lucida Console", Monaco, monospace'
            },
            rotation: -0.5 * Math.PI,
            circumference: 2 * Math.PI
          },
          onResize: function() {
            $("#chart-{{SURI_INSTANCE_ID}}").height($(".widget-{{SURI_INSTANCE_ID}}").height() - 130);
            $("#chart-{{SURI_INSTANCE_ID}}").width($(".widget-{{SURI_INSTANCE_ID}}").width() - 40);
            chart.update();
          }
        });
      }

      if (page_loaded) {
        loadChart{{SURI_INSTANCE_ID}}();
      }
    });
</script>
